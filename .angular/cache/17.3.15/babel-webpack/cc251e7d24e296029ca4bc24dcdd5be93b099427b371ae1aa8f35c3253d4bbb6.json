{"ast":null,"code":"import _asyncToGenerator from \"/home/nigel/work/safe-space/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators, FormControl } from '@angular/forms';\nimport { get, onValue, push, ref, set } from '@angular/fire/database';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/fire/database\";\nimport * as i4 from \"@angular/fire/auth\";\nimport * as i5 from \"@angular/common\";\nfunction UserReportsPage_ion_grid_11_ion_row_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-row\")(1, \"ion-col\", 10)(2, \"ion-card\")(3, \"ion-card-header\")(4, \"ion-card-title\");\n    i0.ɵɵtext(5, \"No Reports Yet\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"ion-card-content\")(7, \"p\");\n    i0.ɵɵtext(8, \"You haven't submitted any reports yet.\");\n    i0.ɵɵelementEnd()()()()();\n  }\n}\nfunction UserReportsPage_ion_grid_11_ion_col_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-col\", 11)(1, \"ion-card\")(2, \"ion-card-header\")(3, \"ion-card-title\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-card-subtitle\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"ion-card-content\")(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const report_r1 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(report_r1.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(report_r1.number);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(report_r1.message);\n  }\n}\nfunction UserReportsPage_ion_grid_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-grid\", 7);\n    i0.ɵɵtemplate(1, UserReportsPage_ion_grid_11_ion_row_1_Template, 9, 0, \"ion-row\", 8);\n    i0.ɵɵelementStart(2, \"ion-row\");\n    i0.ɵɵtemplate(3, UserReportsPage_ion_grid_11_ion_col_3_Template, 10, 3, \"ion-col\", 9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.reports.length === 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.reports);\n  }\n}\nfunction UserReportsPage_ion_fab_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-fab\", 12)(1, \"ion-fab-button\", 13);\n    i0.ɵɵlistener(\"click\", function UserReportsPage_ion_fab_12_Template_ion_fab_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.openReportForm());\n    });\n    i0.ɵɵelement(2, \"ion-icon\", 14);\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction UserReportsPage_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 15)(1, \"h2\");\n    i0.ɵɵtext(2, \"Submit New Report\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"form\", 16);\n    i0.ɵɵlistener(\"ngSubmit\", function UserReportsPage_div_13_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.sendReport(ctx_r1.validations_form.value));\n    });\n    i0.ɵɵelementStart(4, \"ion-item\")(5, \"ion-label\", 17);\n    i0.ɵɵtext(6, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"ion-input\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ion-item\")(9, \"ion-label\", 17);\n    i0.ɵɵtext(10, \"Phone Number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(11, \"ion-input\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"ion-item\")(13, \"ion-label\", 17);\n    i0.ɵɵtext(14, \"Message\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"ion-textarea\", 20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 15)(17, \"ion-button\", 21);\n    i0.ɵɵtext(18, \"Submit Report\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-button\", 22);\n    i0.ɵɵlistener(\"click\", function UserReportsPage_div_13_Template_ion_button_click_19_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.showForm = false);\n    });\n    i0.ɵɵtext(20, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.validations_form);\n    i0.ɵɵadvance(14);\n    i0.ɵɵproperty(\"disabled\", !ctx_r1.validations_form.valid);\n  }\n}\nexport let UserReportsPage = /*#__PURE__*/(() => {\n  class UserReportsPage {\n    navCtrl;\n    formBuilder;\n    database;\n    auth;\n    modalController;\n    validations_form;\n    errorMessage = '';\n    successMessage = '';\n    reports = [];\n    showForm = false;\n    constructor(navCtrl, formBuilder, database, auth, modalController) {\n      this.navCtrl = navCtrl;\n      this.formBuilder = formBuilder;\n      this.database = database;\n      this.auth = auth;\n      this.modalController = modalController;\n    }\n    ngOnInit() {\n      this.validations_form = this.formBuilder.group({\n        name: new FormControl('', Validators.required),\n        number: new FormControl('', Validators.required),\n        message: new FormControl('', Validators.required)\n      });\n      this.loadReports();\n    }\n    openReportForm() {\n      this.showForm = true;\n    }\n    loadReports() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (_this.auth.currentUser) {\n          const userReportsRef = ref(_this.database, `reports/${_this.auth.currentUser.uid}`);\n          onValue(userReportsRef, snapshot => {\n            _this.reports = [];\n            snapshot.forEach(childSnapshot => {\n              const report = childSnapshot.val();\n              report.id = childSnapshot.key;\n              _this.reports.push(report);\n            });\n          });\n        }\n      })();\n    }\n    sendReport(value) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (_this2.auth.currentUser) {\n          const userReportsRef = ref(_this2.database, `reports/${_this2.auth.currentUser.uid}`);\n          const newReportRef = push(userReportsRef);\n          yield set(newReportRef, value);\n          _this2.validations_form.reset();\n          _this2.showForm = false;\n          _this2.navCtrl.navigateForward('/home/user-reports');\n        }\n      })();\n    }\n    getReport(id) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        if (_this3.auth.currentUser) {\n          const reportRef = ref(_this3.database, `reports/${_this3.auth.currentUser.uid}/${id}`);\n          const snapshot = yield get(reportRef);\n          return snapshot.val();\n        }\n        return null;\n      })();\n    }\n    static ɵfac = function UserReportsPage_Factory(t) {\n      return new (t || UserReportsPage)(i0.ɵɵdirectiveInject(i1.NavController), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.Database), i0.ɵɵdirectiveInject(i4.Auth), i0.ɵɵdirectiveInject(i1.ModalController));\n    };\n    static ɵcmp = (() => /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: UserReportsPage,\n      selectors: [[\"app-user-reports\"]],\n      decls: 14,\n      vars: 3,\n      consts: [[\"slot\", \"start\"], [\"fullscreen\", \"true\"], [\"collapse\", \"condense\"], [\"size\", \"large\"], [\"fixed\", \"\", 4, \"ngIf\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\", 4, \"ngIf\"], [\"class\", \"ion-padding\", 4, \"ngIf\"], [\"fixed\", \"\"], [4, \"ngIf\"], [\"size\", \"12\", \"size-md\", \"6\", 4, \"ngFor\", \"ngForOf\"], [\"size\", \"12\", 1, \"ion-text-center\"], [\"size\", \"12\", \"size-md\", \"6\"], [\"vertical\", \"bottom\", \"horizontal\", \"end\", \"slot\", \"fixed\"], [3, \"click\"], [\"name\", \"add\"], [1, \"ion-padding\"], [3, \"ngSubmit\", \"formGroup\"], [\"position\", \"floating\"], [\"formControlName\", \"name\", \"type\", \"text\"], [\"formControlName\", \"number\", \"type\", \"tel\"], [\"formControlName\", \"message\", \"rows\", \"6\"], [\"expand\", \"block\", \"type\", \"submit\", 3, \"disabled\"], [\"expand\", \"block\", \"fill\", \"outline\", 3, \"click\"]],\n      template: function UserReportsPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n          i0.ɵɵelement(3, \"ion-menu-button\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"ion-title\");\n          i0.ɵɵtext(5, \"Reports\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(6, \"ion-content\", 1)(7, \"ion-header\", 2)(8, \"ion-toolbar\")(9, \"ion-title\", 3);\n          i0.ɵɵtext(10, \"Reports\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(11, UserReportsPage_ion_grid_11_Template, 4, 2, \"ion-grid\", 4)(12, UserReportsPage_ion_fab_12_Template, 3, 0, \"ion-fab\", 5)(13, UserReportsPage_div_13_Template, 21, 2, \"div\", 6);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(11);\n          i0.ɵɵproperty(\"ngIf\", !ctx.showForm);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.showForm);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.showForm);\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf, i2.ɵNgNoValidate, i2.NgControlStatus, i2.NgControlStatusGroup, i2.FormGroupDirective, i2.FormControlName, i1.IonButton, i1.IonButtons, i1.IonCard, i1.IonCardContent, i1.IonCardHeader, i1.IonCardSubtitle, i1.IonCardTitle, i1.IonCol, i1.IonContent, i1.IonFab, i1.IonFabButton, i1.IonGrid, i1.IonHeader, i1.IonIcon, i1.IonInput, i1.IonItem, i1.IonLabel, i1.IonMenuButton, i1.IonRow, i1.IonTextarea, i1.IonTitle, i1.IonToolbar, i1.TextValueAccessor]\n    }))();\n  }\n  return UserReportsPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}